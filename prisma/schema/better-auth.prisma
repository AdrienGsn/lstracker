model User {
    id            String    @id @default(cuid())
    name          String
    email         String
    emailVerified Boolean
    image         String?
    role          String?   @default("user")
    banned        Boolean?  @default(false)
    banReason     String?
    banExpires    DateTime?

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    sessions    Session[]
    accounts    Account[]
    members     Member[]
    invitations Invitation[]
    BugReport   BugReport[]
    teamMembers TeamMember[]

    @@unique([email])
    @@map("user")
}

model Session {
    id                   String   @id @default(cuid())
    expiresAt            DateTime
    token                String
    ipAddress            String?
    userAgent            String?
    userId               String
    activeOrganizationId String?
    activeTeamId         String?
    impersonatedBy       String?

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    user User @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@unique([token])
    @@map("session")
}

model Account {
    id                    String    @id @default(cuid())
    accountId             String
    providerId            String
    userId                String
    accessToken           String?
    refreshToken          String?
    idToken               String?
    accessTokenExpiresAt  DateTime?
    refreshTokenExpiresAt DateTime?
    scope                 String?
    password              String?

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    user User @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@unique([providerId, accountId])
    @@map("account")
}

model Verification {
    id         String   @id @default(cuid())
    identifier String
    value      String
    expiresAt  DateTime
    createdAt  DateTime @default(now())
    updatedAt  DateTime @updatedAt

    @@unique([identifier, value])
    @@map("verification")
}

model Organization {
    id       String  @id @default(cuid())
    name     String
    slug     String?
    logo     String?
    metadata String?

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    members     Member[]
    invitations Invitation[]
    teams       Team[]

    @@unique([slug])
    @@map("organization")
}

model Member {
    id             String @id @default(cuid())
    organizationId String
    userId         String
    role           String

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
    user         User         @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@unique([userId, organizationId])
    @@map("member")
}

model Invitation {
    id             String   @id @default(cuid())
    organizationId String
    email          String
    role           String?
    status         String
    expiresAt      DateTime
    inviterId      String

    organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
    inviter      User         @relation(fields: [inviterId], references: [id], onDelete: Cascade)

    @@map("invitation")
}

model Team {
    id             String  @id @default(cuid())
    name           String
    slug           String
    organizationId String
    metadata       String?

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
    members      TeamMember[]

    @@unique([organizationId, slug])
    @@map("team")
}

model TeamMember {
    id     String @id @default(cuid())
    teamId String
    userId String

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    team Team @relation(fields: [teamId], references: [id], onDelete: Cascade)
    user User @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@unique([teamId, userId])
    @@map("teamMember")
}
